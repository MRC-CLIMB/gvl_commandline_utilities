<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="description" content="GVL commandline utilities : Scripts for users of GVL cloud instances. These scripts configure GVL servers as command-line bioinformatics platforms.">

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>GVL commandline utilities</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/gvlproject/gvl_commandline_utilities">View on GitHub</a>

          <h1 id="project_title">GVL commandline utilities</h1>
          <h2 id="project_tagline">Scripts for users of GVL cloud instances. These scripts configure GVL servers as command-line bioinformatics platforms.</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/gvlproject/gvl_commandline_utilities/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/gvlproject/gvl_commandline_utilities/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h1>
<a id="gvl_commandline_utilities" class="anchor" href="#gvl_commandline_utilities" aria-hidden="true"><span class="octicon octicon-link"></span></a>gvl_commandline_utilities</h1>

<p>Scripts useful for users of GVL cloud images (CloudMan instances).
These scripts configure GVL instances as command-line bioinformatics platforms, including RStudio and IPython Notebook (through JupyterHub) setup.</p>

<h2>
<a id="how-to-run-these-scripts" class="anchor" href="#how-to-run-these-scripts" aria-hidden="true"><span class="octicon octicon-link"></span></a>How to run these scripts</h2>

<p>To use, launch a GVL instance ( <a href="https://docs.google.com/document/d/1uYKWZckyR8kZSY6viECMJsGSTaNsS2nVMj5n_YYzxGY/pub">instructions here</a> ), ssh in as user ubuntu, and run</p>

<pre><code>git clone https://github.com/gvlproject/gvl_commandline_utilities
cd gvl_commandline_utilities
sh run_all.sh
</code></pre>

<p>This version of gvl_commandline_utilities is intended to run on GVL image 4.0 or later.</p>

<p>You can run these scripts as an ansible playbook, which gives the most flexibility. Basic usage:</p>

<pre><code>ansible-playbook playbook.yml
</code></pre>

<p>Available playbook tags:</p>

<ul>
<li>
<code>setup_user</code> : do not bother to rerun global config, just create and configure a new user account</li>
<li>
<code>toolshed_modules</code> : just rerun toolshed_to_modules.py</li>
</ul>

<p>These tags are wrapped in <code>setup_user.sh</code> and <code>toolshed_to_modules.sh</code> for
backwards-compatibility.</p>

<p>Available variables can be found in <code>roles/gvl.commandline-utilities/defaults/</code> .
Notable variables are:</p>

<ul>
<li>
<code>new_user</code> : the username of the account to be created or reconfigured</li>
<li>
<code>use_ubuntu_password</code> (default is <code>use_ubuntu_password=yes</code>) : use the ubuntu/CloudMan password as the new user's password. This mode will not prompt for a password. <code>use_ubuntu_password=no</code> is more secure.</li>
</ul>

<p>Several convenience scripts are provided for backwards-compatibility. These are just
wrappers around ansible. These are:</p>

<ul>
<li>
<code>run_all.sh</code> : configure your instance for command-line use and install services.</li>
<li>
<code>setup_user.sh</code> : after running <code>run_all.sh</code>, can be run again to configure additional user accounts. This is a wrapper around <code>--tags "setup_user"</code>.</li>
<li>
<code>toolshed_to_modules.sh</code> : after running <code>run_all.sh</code>, can be run again to update module files. This is useful if tools have been added or removed using the Galaxy Toolshed. This is a wrapper around <code>--tags "toolshed_modules"</code>.</li>
</ul>

<h2>
<a id="how-to-use-installed-features" class="anchor" href="#how-to-use-installed-features" aria-hidden="true"><span class="octicon octicon-link"></span></a>How to use installed features</h2>

<p>Running <code>run_all.sh</code> will create a non-sudo account called "researcher", with various services configured.
It is more secure and convenient to use the researcher account for ordinary research activities, but
to carry out admin actions, you will need to use a sudoer account such as ubuntu.</p>

<p>To access the below features, the best way is to log out of the ubuntu account and ssh in as user researcher. Alternatively if you are already logged in as ubuntu, you can run</p>

<pre><code>su - researcher
script /dev/null
</code></pre>

<p>(The script command will allow you to use screen after running su.)</p>

<p>You can then find documentation on most of the features described on this page by examining the
README.txt file in your home directory:</p>

<pre><code>less ~/README.txt
</code></pre>

<p>To access specific services, including those that come pre-installed on GVL instances:</p>

<p><strong>CloudMan</strong> is already installed, without running these scripts.
It is accessible at</p>

<pre><code>http://&lt;your-ip-address&gt;/cloud
</code></pre>

<p><strong>VNC, for remote desktop access</strong> is already installed, without running these scripts.
It is accessible at</p>

<pre><code>http://&lt;your-ip-address&gt;/vnc
</code></pre>

<p><strong>Galaxy</strong> is already installed, without running these scripts. The Galaxy application directory
can be found via the symlink <code>~/galaxy</code>, and Galaxy is accessible at</p>

<pre><code>http://&lt;your-ip-address&gt;/
</code></pre>

<p><strong>Galaxy-installed reference genomes</strong>, as well as genome indices created by Galaxy-installed
tools, can be accessed by command-line users via the symlink <code>~/galaxy_genomes</code> .
Unless configured otherwise, this directory tree will be mounted using a shared filesystem and
therefore read-only.</p>

<p><strong>Galaxy Datasets</strong> can be mounted for direct read access using the galaxy-fuse script,
which can be found in your home directory at <code>~/galaxy-fuse.py</code>. You will need your Galaxy API key,
found by logging into Galaxy and selecting the menu option User -&gt; API Keys.
To use, run</p>

<pre><code>python galaxy-fuse.py &lt;api-key&gt; &amp;
</code></pre>

<p>This puts the galaxy-fuse process into the background. After running the above command,
Galaxy Datasets will appear as read-only files, organised by History, by default under
the directory <code>galaxy_files</code>.</p>

<p>See the notes on the <code>galaxy-fuse.py</code> script below for caveats.</p>

<p>A per-user <strong>web-accessible folder</strong> can be found at <code>~/public_html</code> . Any files you place in this
directory will be <em>publicly</em> accessible at</p>

<pre><code>http://&lt;your-ip-address&gt;/public/researcher/&lt;filename&gt;
</code></pre>

<p>If you create extra user accounts using <code>setup_user.sh</code>, each account will get a similar folder which redirects
to a URL as above, with <code>researcher</code> replaced by the relevant username.</p>

<p><strong>RStudio</strong> is accessible at</p>

<pre><code>http://&lt;your-ip-address&gt;/rstudio/
</code></pre>

<p>You can log into RStudio with username "researcher" and the corresponding linux password.
Any other linux accounts created by running <code>setup_user.sh</code> will similarly have RStudio accounts.</p>

<p><strong>JupyterHub</strong>, a multi-user IPython notebook server, has been installed and will be available at</p>

<pre><code>http://{{ ip_address }}/jupyterhub/
</code></pre>

<p>You can log into JupyterHub with username "researcher" and the corresponding linux password.
Any other linux accounts created by running <code>setup_user.sh</code> will similarly have JupyterHub accounts.</p>

<p>Anyone who knows the password to your JupyterHub server will be able to execute
arbitrary code under your account, so keep this password private. You should treat
it as you would your ssh login credentials.</p>

<p><strong>Tools installed as part of CloudBioLinux</strong> will be in the usual locations for binaries,
and usually already in your path.</p>

<p><strong>Tools installed by the Galaxy Toolshed</strong> will not be in your path and multiple versions
of some tools may be available. Environment modules (<a href="http://modules.sourceforge.net/">http://modules.sourceforge.net/</a>) have been created
and will give access to most installed Galaxy Toolshed tools. You can see available Toolshed-installed
tools by running</p>

<pre><code>module avail
</code></pre>

<p>Refer to the <code>module</code> documentation for instructions on loading, viewing and unloading modules.
If Toolshed tools have been added or removed, rerunning the relevant ansible task using <code>toolshed_to_modules.sh</code> will update the environment modules.</p>

<p>Consult <a href="http://www.genome.edu.au/">http://www.genome.edu.au/</a> for further documentation on GVL instances.</p>

<h3>
<a id="galaxy-fusepy" class="anchor" href="#galaxy-fusepy" aria-hidden="true"><span class="octicon octicon-link"></span></a>galaxy-fuse.py</h3>

<p>This script is in <code>roles/gvl.commandline-utilities/files/</code> and will be copied to the home directory of each ordinary user, e.g. to
<code>~researcher/galaxy-fuse.py</code>. It is <em>not</em> currently called as part of the setup process.</p>

<p>To use this, you should log in as an ordinary user (e.g. <code>researcher</code>). You will
need your Galaxy API key, found by logging into Galaxy and selecting the menu
option User -&gt; API Keys. You can mount your Galaxy Datasets using a command like</p>

<pre><code>python galaxy-fuse.py &lt;api-key&gt; &amp;
</code></pre>

<p>This puts the galaxy-fuse process into the background. After running the above command,
Galaxy Datasets will appear as read-only files, organised by History, by default under
the directory <code>galaxy_files</code>.</p>

<p>Note that:</p>

<ul>
<li>Galaxy Datasets will be read-only, since writing to them directly is not supported
by the Galaxy API</li>
<li>Datasets with non-unique names will have the Dataset ID appended to disambiguate them</li>
<li>History or Dataset names containing a slash (/) are escaped to '%-'</li>
</ul>

<p>galaxy-fuse was originally written by Dr David Powell and began life at
<a href="https://github.com/drpowell/galaxy-fuse">https://github.com/drpowell/galaxy-fuse</a> .</p>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">GVL commandline utilities maintained by <a href="https://github.com/gvlproject">gvlproject</a></p>
        <p>Published with <a href="https://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
